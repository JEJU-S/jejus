<!DOCTYPE html>
<html>
    <head>
        <!--Ïª¨Îü¨,Ìè∞Ìä∏, Î°úÍ≥† ÎπºÍ≥† ÏûëÏóÖ ÏôÑÎ£åÎêú ÎìØ..?-->
        <meta charset = "UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
		<link rel="stylesheet" href="/public/css/header.css">
        <link rel="stylesheet" href="/public/css/sidebar.css">
        <link rel="stylesheet" href="/public/css/base.css">
		<link rel="stylesheet" href="/public/css/footer.css">
		<link rel="stylesheet" href="/public/css/see-plan.css">
        <script type="text/javascript" src="https://openapi.map.naver.com/openapi/v3/maps.js?ncpClientId=<%=map_cl%>"></script>
        
        <!--Íµ¨Í∏Ä ÏïÑÏù¥ÏΩò-->
        <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
		<link rel="stylesheet" href="/public/css/icon.css">
        <!--Íµ¨Í∏Ä ÏõπÌè∞Ìä∏-->
        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link href="https://fonts.googleapis.com/css2?family=Gowun+Dodum&display=swap" rel="stylesheet">
        <!--JQuery-->
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.4/jquery.min.js"></script>
        <title> <%=totPlan.title%> | Sample </title>
    </head>
    <body class="container">
        <div class="inv-area">
            <form class="email-form" method="post">
                <div>
                    <span>Í∑∏Î£πÏõê Ï¥àÎåÄÌïòÍ∏∞</span>
                    <input type="reset" value="‚ùå">
                </div>
                <input type="email", placeholder="gmailÏùÑ ÏûÖÎ†•ÌïòÏÑ∏Ïöî" name="gmail" required>
                <input type="submit" value="Ï¥àÎåÄÌïòÍ∏∞">
            </form>
        </div>
        <header>
            <div class="logo-box">
                <a href="/users/<%=user._id%>"><img src="/public/images/logo.png" alt="logo" class="logo"></a>
            </div>
        </header>
        <div class="sidebar"> <!--ÏÇ¨Ïù¥Îìú Î∞î-->
            <div class="side-profile"> <!--ÌîÑÎ°úÌïÑ ÏÇ¨ÏßÑ ÌÅ¨Í∏∞ ÎßûÏ∂§ÏùÑ ÏúÑÌï¥ "photo-box" div Ï∂îÍ∞Ä-->
                <div class="photo-box"> <!--ÌîÑÎ°úÌïÑ ÏÇ¨ÏßÑ ÌÅ¨Í∏∞ ÎßûÏ∂§ÏùÑ ÏúÑÌï¥ ÏÇ¨ÏßÑÏóê "profile-img" class Ï∂îÍ∞Ä-->
                    <img class="profile-img" src="<%=user.image_url%>" alt="user photo"/>
                </div>
                <!--ÌîÑÎ°úÌïÑ ÎÇ¥ Ï†ïÎ≥¥Îì§ÏùÑ boxÎ°ú Î¨∂Í∏∞ ÏúÑÌï¥ "user-info" div Ï∂îÍ∞Ä-->
                <div class="user-info">
                    <p class="side-user-name"><%=user.name%></p>
                    <p><%=user.gmail%></p>
                </div>
            </div>
            <!--ÏÇ¨Ïù¥ÎìúÎ∞î Î©îÎâ¥Íµ¨ÏÑ± ÏãúÏûë-->
            <div class="menu">
                <!--Î©îÎâ¥ÎßàÎã§ ÏòÅÏó≠ÏùÑ ÏßÄÏ†ïÌïòÍ≥†, ÏÉâÍπî Îì± Ìö®Í≥ºÎ•º ÏùºÍ¥ÑÏ†ÅÏúºÎ°ú ÏûÖÌûàÍ∏∞ ÏúÑÌï¥ menu-name ÌÅ¥ÎûòÏä§ Î∂ÄÏó¨-->
                <div class="menu-name">
                    <span class="material-icons md-36">
                        account_circle
                        </span>
                        <span><a href="/users/<%=user._id%>">ÎßàÏù¥ÌéòÏù¥ÏßÄ</a></span>
                </div>
                <div class="menu-name">
                    <span class="material-icons md-36">
                        create_new_folder</span>
                    <span><a href="/plans/create">ÏÉà Í≥ÑÌöç ÎßåÎì§Í∏∞</a></span>
                </div>
                <div class="menu-name group selected" id="sidebar-group">
                    <div class="mygroup"  id="group">
                        <span class="material-icons md-36 grid">
                            folder
                        </span>
                        <span >ÎÇ¥ Í∑∏Î£π</span>

                    </div>
                    <!--ÏÑ∏Î∂ÄÎ©îÎâ¥Ïùò ÏòÅÏó≠ÏùÑ ÏßÄÏ†ïÌïòÍ≥†, ÏÉâÍπî Îì± Ìö®Í≥ºÎ•º ÏùºÍ¥ÑÏ†ÅÏúºÎ°ú ÏûÖÌûàÍ∏∞ ÏúÑÌï¥ menu-detail ÌÅ¥ÎûòÏä§ Î∂ÄÏó¨-->
                    <div class="menu-detail" id="mygroup">
                        <ul>
                            <%totPlanTitles.forEach(function(title){ %>
                            <li><a href="/plans/<%=title['_id']%>" class="side-plan-title"><%=title['title']%></a></li>
                            <% })%>
                        </ul>
                    </div>
                </div>
                <div class="menu-name logout">
                    <span class="material-icons md-36">
                        logout
                        </span><a href="/users/logout">Î°úÍ∑∏ÏïÑÏõÉ</a>
                </div>
            </div>
		</div>
        <!--Î©îÏù∏ ÌéòÏù¥ÏßÄ-->
                    <!--Îç∞Ïù¥ Î≤ÑÌäºÏù¥ Î©îÏù∏Ïóê ÎÑ£ÏùÑ Ïãú Î©îÏù∏Ïª®ÌÖêÏ∏†ÏôÄ Í≤πÏπòÍ≤å ÌëúÏãúÎêòÏñ¥ Îî∞Î°ú daybuttonÏúºÎ°ú Î∂ÑÎ¶¨ÌïòÏòÄÍ≥†, ÏöîÏÜåÎ≥Ñ ÏòÅÏó≠ Î∂ÄÏó¨Î•º ÏúÑÌï¥ day-button ÌÅ¥ÎûòÏä§Î•º ÏûÖÌûò-->
        <div class="day-button"><!--id Î°ú Ìï¥Ïïº ÌïòÎÇò?-->
            <div class="btn" id="info-btn"><a>info</a></div>
            <%let day%>
            <% for(day = 0; day < totPlan.day_plan.length; day++){ %>
            <!--day button Ïù¥Î¶Ñ Î∞îÍæ∏Í∏∞-->
            <div class="btn">day <%=day + 1%></div>
            <%}%>
        </div>
        <main>
            <!--ÏûêÎ∞îÏä§ÌÅ¨Î¶ΩÌä∏Î°ú ÎÇ†ÏßúÎ≥Ñ div ÏÉùÏÑ± ÌõÑ Î≤ÑÌäºÏóê Ìï¥ÎãπÎêòÎäî ÎÇ†ÏßúÏùò div Î≥¥Ïó¨Ï§òÏïº Ìï® / db Î∞îÍæ∏Î©¥ Îã¨ÎùºÏßà Ïàò ÏûàÏùå-->
            <!--Îç∞Ïù¥Î≤ÑÌäº ÌÅ¥Î¶≠ÎßàÎã§ Îã§Î•∏ ÎÇ¥Ïö©ÏùÑ Î≥¥Ïó¨Ï£ºÏñ¥Ïïº Ìï®. Ï†ÑÏ≤¥ ÌéòÏù¥ÏßÄÏù∏ whole-planÍ≥º day-planÏúºÎ°ú Ï†ÑÏ≤¥ÌéòÏù¥ÏßÄÏôÄ ÏÑ∏Î∂ÄÎÇ¥Ïö© ÌéòÏù¥ÏßÄÎ•º Î∂ÑÎ¶¨Ìï¥ÏÑú ÏûëÏÑ±ÌñàÏùå. Í∞Å cssÏùò displayÎ•º Î≤ÑÌäº ÌÅ¥Î¶≠Ïóê Îî∞Îùº none <->grid Î°ú Î≥ÄÍ≤ΩÌïòÎäî ÏûëÏóÖ ÌïÑÏöî.-->
            <div class="whole-plan" data-planid="<%=totPlan._id%>">
                <div class="plan-title">
                    <h1><%=totPlan.title%></h1>
                    <%if(user._id == totPlan.admin["_id"]){%>
                        <button type="button" class="del-btn"><span class="material-icons md-2">
                            delete
                            </span><span>ÏÇ≠Ï†ú</span>
                            </button>
                    <%}%>
                </div>
                <div class="plan-info">
                    <div class="date">
                        <div>
                            <span>
                                <%=totPlan.day_plan[0].date.getFullYear()%>ÎÖÑ 
                                <%=totPlan.day_plan[0].date.getMonth() + 1%>Ïõî 
                                <%=totPlan.day_plan[0].date.getDate()%>Ïùº 
                            </span>
                        </div>
                            /
                        <div>
                            <span>
                                <%=totPlan.day_plan[day-1].date.getFullYear()%>ÎÖÑ
                                <%=totPlan.day_plan[day-1].date.getMonth() + 1%>ÎÖÑ
                                <%=totPlan.day_plan[day-1].date.getDate()%>Ïùº
                            </span>
                        </div>
                    </div>
                <!--total-map(Ï†ÑÏ≤¥ Í≤ΩÎ°ú ÎßàÏª§) Ï≤òÎ¶¨ Î∂ÄÎ∂Ñ-->
                    <div id="total-map" data-dayplan="<%=JSON.stringify(totPlan.day_plan)%>"></div>
                    <h2>Ï∞∏Ïó¨Ïûê</h2>
                    <div class="participants">
                        <%totPlan.participants.forEach(function(participant){%>
                            <div class="user">
                                <div class="userimg">
                                    <img class="profile-img" src="<%=participant.image_url%>" alt="user photo"/>
                                </div>
                                    <%=participant.name%>
                                    <%if(participant._id.toString() === totPlan.admin["_id"].toString()){%>
                                        üëë
                                    <%}%>
                            </div>
                        <%})%>
                    </div>
                    <div class="btns">
                        <div class="plan-buttons">
                            <button type="button" class="edit-btn"><span class="material-icons">
                                edit
                                </span>
                                Ìé∏Ïßë</button>
                            <button class="inv-btn"><span class="material-icons">
                                send
                                </span>
                                Ï¥àÎåÄ</button>
                        </div>
                    </div>
                </div>
            </div>

            <!--day plan-->
            <%for(day=0; day < totPlan.day_plan.length; day++){%>
            <div class="day-plan">
                <h1 class="plan-day">day <%=day + 1%></h1>
                
                <div id="day-map<%=day + 1%>" data-dayindex="<%=day%>", class="day-map"></div>

                <div class="place-object"><!--classÎ™Ö Îã§Ïãú Î∞îÍæ∏Î©¥ Ï¢ãÍ≤†Îã§-->
                    <%if(totPlan.day_plan[day]['place'].length === 0){%>
                    <span>ÏïÑÏßÅ ÏÑ∏Î∂Ä Í≥ÑÌöçÏù¥ ÏóÜÏñ¥Ïöî.. <a class="edit-link">ÏÉà Í≥ÑÌöç</a>ÏùÑ Ï∂îÍ∞ÄÌï¥Î≥¥ÏÑ∏Ïöî!</span>
                    <%}%>
                    <% for(let placeIndex = 0; placeIndex < totPlan.day_plan[day]['place'].length; placeIndex++){ %>
                        <div class="p-obj">
                            <h3 class="obj-name"><%=totPlan.day_plan[day]['place'][placeIndex]['name']%><button class="more-btn"><span class="material-icons">open_in_new</span></button></h3>
                            <p class="obj-adress"><%=totPlan.day_plan[day]['place'][placeIndex]['road_adr']%></p>
                        </div>
                    <%}%>
                </div>
            </div>
            <%}%>
        </main>
            <footer>
                &copy; <%=new Date().getFullYear()%> Sample Project
            </footer>
    </body>
    <script type="text/javascript" src="/public/js/see-plan.js"></script>
    <script type="text/javascript" src="/public/js/menu-opener.js"></script>
    <script type="module" src="/public/js/sidebar.js"></script>
</html>
